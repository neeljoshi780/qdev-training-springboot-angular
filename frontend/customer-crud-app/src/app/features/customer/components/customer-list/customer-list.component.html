<div class="customer-list-container">
  <div class="list-header">
    <h2>Customer List</h2>
    <div class="list-actions">
      <a routerLink="/customers/add"> + Add Customer </a>
    </div>

    <!-- Search box -->
    <div class="table-toolbar">
      <input
        type="text"
        placeholder="Search customers..."
        [(ngModel)]="searchText"
        (keyup)="onSearch()"
      />
    </div>
  </div>

  <div class="table-wrapper">
    <table class="customer-table">
      <thead>
        <tr>
          <th>
            ID<span class="sort-icon" (click)="sort('id')">{{
              getSortIcon("firstName")
            }}</span>
          </th>
          <th>
            Full Name<span class="sort-icon" (click)="sort('firstName')">{{
              getSortIcon("firstName")
            }}</span>
          </th>
          <th>
            Address<span class="sort-icon" (click)="sort('id')">{{
              getSortIcon("address1")
            }}</span>
          </th>
          <th>
            DOB<span class="sort-icon" (click)="sort('id')">{{
              getSortIcon("dateOfBirth")
            }}</span>
          </th>
          <th>
            Age<span class="sort-icon" (click)="sort('id')">{{
              getSortIcon("age")
            }}</span>
          </th>
          <th>
            Gender<span class="sort-icon" (click)="sort('id')">{{
              getSortIcon("gender")
            }}</span>
          </th>
          <th>
            Email<span class="sort-icon" (click)="sort('id')">{{
              getSortIcon("email")
            }}</span>
          </th>
          <th>
            Mobile<span class="sort-icon" (click)="sort('id')">{{
              getSortIcon("mobile")
            }}</span>
          </th>
          <th>Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let customer of pageResponse?.content">
          <td>{{ customer.id }}</td>
          <td>{{ customer.firstName }} {{ customer.lastName }}</td>
          <td>
            {{ customer.address1
            }}{{ customer.address2 ? ", " + customer.address2 : "" }}
          </td>
          <td>{{ customer.dateOfBirth | date : "dd/MM/yyyy" }}</td>
          <td>{{ customer.age }}</td>
          <td>{{ customer.gender }}</td>
          <td>{{ customer.email }}</td>
          <td>{{ customer.mobile }}</td>
          <td>
            <button class="btn-edit" (click)="onEdit(customer.id)">Edit</button>
            <button class="btn-delete" (click)="openDeleteModal(customer.id)">
              Delete
            </button>
          </td>
        </tr>

        <tr *ngIf="pageResponse?.content?.length === 0">
          <td colspan="9" class="no-data">No customers found</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="pagination" *ngIf="pageResponse as pr">
    <button [disabled]="!pr.hasPrevious" (click)="loadPage(pr.pageNumber - 1)">
      Previous
    </button>

    <span> Page {{ pr.pageNumber + 1 }} of {{ pr.totalPages }} </span>

    <button [disabled]="!pr.hasNext" (click)="loadPage(pr.pageNumber + 1)">
      Next
    </button>
  </div>
  <!-- Page size selector -->
  <div class="page-size-wrapper">
    <label for="pageSize">Show</label>

    <select id="pageSize" [(ngModel)]="pageSize" (change)="onPageSizeChange()">
      <option [ngValue]="10">10</option>
      <option [ngValue]="20">20</option>
      <option [ngValue]="50">50</option>
      <option [ngValue]="100">100</option>
    </select>

    <span>entries</span>
  </div>
</div>

<!-- Delete Confirmation -->
<div class="modal-backdrop" *ngIf="showDeleteModal">
  <div class="modal">
    <h3>Delete Customer</h3>
    <p>Are you sure you want to delete this customer?</p>

    <div class="modal-actions">
      <button class="btn-secondary" (click)="closeDeleteModal()">Cancel</button>
      <button class="btn-danger" (click)="confirmDelete()">Delete</button>
    </div>
  </div>
</div>
